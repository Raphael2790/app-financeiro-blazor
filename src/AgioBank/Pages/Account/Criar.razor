@page "/Criar"

@inject IServicoConta ServicoConta

<h3>Nova Conta</h3>

@if (_result != null)
{
    @if (_result.Success)
    {
        <div class="alert alert-success" role="alert">
            Conta criada com sucesso!
        </div>
    }
    else
    {
        <div class="alert alert-danger" role="alert">
            Falha ao criar conta: @_result.Message
        </div>
    }
}

<EditForm Model="@_model" OnValidSubmit="OnValidSubmitAsync">
    <DataAnnotationsValidator />

    <div class="mb">
        <InputText class="form-input" @bind-Value = "_model!.Nome" placeholder = "Nome" ></InputText>
        <span class="form-input-invalid">
            <ValidationMessage For = "@(() => _model.Nome)"/>
        </span>
    </div>

    <div class="mb">
        <InputText class="form-input" @bind-Value="_model!.Sobrenome" placeholder="Sobrenome"></InputText>
        <span class="form-input-invalid">
            <ValidationMessage For="@(() => _model.Sobrenome)" />
        </span>
    </div>

    <div class="mb">
        <InputText class="form-input" @bind-Value="_model!.Telefone" placeholder="Telefone"></InputText>
        <span class="form-input-invalid">
            <ValidationMessage For="@(() => _model.Telefone)" />
        </span>
    </div>

    <div class="mb">
        <InputText class="form-input" @bind-Value="_model!.Email" placeholder="E-mail"></InputText>
        <span class="form-input-invalid">
            <ValidationMessage For="@(() => _model.Email)" />
        </span>
    </div>

    <div class="mb">
        <InputText class="form-input" @bind-Value="_model!.Documento" placeholder="Documento"></InputText>
        <span class="form-input-invalid">
            <ValidationMessage For="@(() => _model.Documento)" />
        </span>
    </div>

    <div class="mb">
        <InputText class="form-input" @bind-Value="_model!.NomeMae" placeholder="Nome da mãe"></InputText>
        <span class="form-input-invalid">
            <ValidationMessage For="@(() => _model.NomeMae)" />
        </span>
    </div>

    <div class="mb">
        <button type="submit" class="btn btn-filled btn-auto mb">
            Criar conta
        </button>
    </div>

</EditForm>

@code {
    private Conta _model = new();
    private ResultadoConta? _result;

    public async Task OnValidSubmitAsync()
    {
        _result = await ServicoConta.Criar(_model);

    }
}
